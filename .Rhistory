library(tidyverse)
library(ggplot2)
library(dplyr)
library(ggsignif)
library(corrplot)
library(caret)
library(pROC)
library(rpart)
library(randomForest)
library(kknn)
library(rpart.plot)
library(ggthemes)
library(NbClust)
ds_row = read.csv("diabetes.csv", stringsAsFactors = FALSE, header = TRUE)
setwd("~/0_data_analysis/Diabetes")
ds_row = read.csv("diabetes.csv", stringsAsFactors = FALSE, header = TRUE)
head(ds_row)
summary(ds_row)
str(ds_row)
ds_row <- as.data.frame(apply(ds_row,2,function(ds_row) as.numeric(ds_row)))
ds_row <- mutate(ds_row, Outcome = as.factor(ds_row$Outcome))
str(ds_row)
sapply(ds_row, function(x) sum(is.na(x)))
# remove outliers
rmv_outliers = function(df, field){
m = mean(df[,field])
s = sd(df[,field])
thrs = 3*s
out = df[df[,field]<=(m+thrs) & df[,field]>=(m-thrs),]
return(out)
# remove outliers
rmv_outliers = function(df, field){
m = mean(df[,field])
s = sd(df[,field])
thrs = 3*s
out = df[df[,field]<=(m+thrs) & df[,field]>=(m-thrs),]
return(out)
}
ds<-ds_row
for (x in names(ds_row)[1:8]){
ds = rmv_outliers(ds,x)
}
str(ds)
#visualisation
#Pregnancies
Pregnancies_Histogram_Plot <- ggplot(ds, aes(Pregnancies, fill = Outcome)) +
geom_histogram(position = "dodge") +
labs(title = "Pregnancies Histogram Plot") +
theme_tufte()
print(Pregnancies_Histogram_Plot)
compared_list = list(c('1', '0'))
Pregnancies_Box_Plot <- ggplot(ds, aes(Outcome, Pregnancies,fill = Outcome))+
geom_boxplot() +
geom_signif(comparisons = compared_list, test = t.test) +
labs(title = "Pregnancies Box Plot") +
theme_tufte()
print(Pregnancies_Box_Plot)
#`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
# remove outliers
rmv_outliers = function(df, field){
m = mean(df[,field])
s = sd(df[,field])
thrs = 3*s
out = df[df[,field]<=(m+thrs) & df[,field]>=(m-thrs),]
return(out)
}
ds<-ds_row
for (x in names(ds_row)[1:8]){
ds = rmv_outliers(ds,x)
}
str(ds)
str(ds)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(ggsignif)
library(corrplot)
library(caret)
library(pROC)
library(rpart)
library(randomForest)
library(kknn)
library(rpart.plot)
library(ggthemes)
library(NbClust)
head(ds_row)
ds_row = read.csv("diabetes.csv", stringsAsFactors = FALSE, header = TRUE)
head(ds_row)

#comment
